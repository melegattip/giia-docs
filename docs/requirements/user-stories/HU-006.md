# HU-006: Registrar Ajustes de Inventario

---

## Metadata

| Campo | Valor |
|-------|-------|
| **ID** | HU-006 |
| **Prioridad** | Must |
| **RF Relacionados** | RF-028, RF-029, RF-030 |
| **Módulo/Componente** | Transacciones - Ingresos y Egresos Extraordinarios |
| **Estado** | Draft |

---

## Historia de Usuario

**Como** Usuario del sistema,  
**Quiero** registrar ingresos y egresos de inventario que no corresponden a compras o ventas regulares,  
**Para** mantener el inventario físico sincronizado con la realidad.

---

## Criterios de Aceptación

### CA-001: Registrar ingreso extraordinario

- **Dado** que recibo una devolución de cliente
- **Cuando** registro un ingreso extraordinario seleccionando tipo "Devolución", producto, cantidad y justificación
- **Entonces** el sistema aumenta el inventario físico del producto

### CA-002: Registrar egreso extraordinario

- **Dado** que detecto una pérdida de productos
- **Cuando** registro un egreso extraordinario seleccionando tipo "Pérdida", producto, cantidad y justificación
- **Entonces** el sistema reduce el inventario físico del producto

### CA-003: Tipos de ingresos disponibles

- **Dado** que necesito registrar un ingreso extraordinario
- **Cuando** selecciono el tipo de movimiento
- **Entonces** veo opciones: Devolución de cliente, Ajuste positivo, Traspaso entrada

### CA-004: Tipos de egresos disponibles

- **Dado** que necesito registrar un egreso extraordinario
- **Cuando** selecciono el tipo de movimiento
- **Entonces** veo opciones: Pérdida, Merma, Obsolescencia, Ajuste negativo, Muestra

### CA-005: Justificación obligatoria

- **Dado** que registro cualquier movimiento extraordinario
- **Cuando** intento guardar sin escribir una justificación
- **Entonces** el sistema muestra error indicando que la justificación es obligatoria

### CA-006: Listar movimientos extraordinarios

- **Dado** que se han registrado múltiples movimientos extraordinarios
- **Cuando** accedo al historial de ajustes
- **Entonces** veo todos los movimientos con filtros por tipo, fecha y producto

---

## Escenarios Alternativos

### Escenario: Egreso mayor al stock disponible

- **Dado** que el producto X tiene 20 unidades en stock
- **Cuando** registro un egreso por 30 unidades
- **Entonces** el sistema muestra advertencia pero permite el registro (inventario negativo posible)

### Escenario: Ajuste múltiple de productos

- **Dado** que realizo un conteo físico de inventario
- **Cuando** registro múltiples ajustes en una sola operación
- **Entonces** el sistema agrupa todos los ajustes bajo un mismo "evento de conteo"

---

## Notas y Aclaraciones

- Todos los movimientos extraordinarios quedan auditados (usuario, fecha/hora, justificación)
- Los ajustes negativos pueden resultar en inventario negativo (pendiente de regularizar)
- El tipo "Obsolescencia" se usa para el KPI de inventario inmovilizado

---

## Checklist de Validación

- [x] La historia sigue el formato "Como... Quiero... Para..."
- [x] El valor/beneficio está claramente expresado
- [x] Hay al menos 1 criterio de aceptación
- [x] Los criterios siguen el formato Given/When/Then
- [x] Los RF relacionados están correctamente referenciados
- [x] La prioridad MoSCoW está asignada

---

## Señal de Completación

> Historia de usuario HU-006 completada.
