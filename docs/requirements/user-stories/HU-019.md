# HU-019: Acceder al Sistema de Forma Segura

---

## Metadata

| Campo | Valor |
|-------|-------|
| **ID** | HU-019 |
| **Prioridad** | Must |
| **RF Relacionados** | RF-095, RF-096, RF-097, RF-098, RF-099, RF-100, RF-101 |
| **Módulo/Componente** | Autenticación y Autorización |
| **Estado** | Draft |

---

## Historia de Usuario

**Como** Usuario del sistema,  
**Quiero** acceder al sistema de forma segura con mi email y contraseña, con acceso limitado según mi rol,  
**Para** proteger los datos de mi organización y realizar solo las acciones autorizadas.

---

## Criterios de Aceptación

### CA-001: Login con email y contraseña

- **Dado** que tengo una cuenta creada
- **Cuando** ingreso mi email y contraseña correctos
- **Entonces** accedo al sistema y veo el dashboard según mis permisos

### CA-002: Login fallido

- **Dado** que ingreso credenciales incorrectas
- **Cuando** intento acceder
- **Entonces** el sistema muestra "Credenciales inválidas" sin especificar qué campo es incorrecto

### CA-003: Recuperar contraseña

- **Dado** que olvidé mi contraseña
- **Cuando** solicito recuperación con mi email
- **Entonces** recibo un enlace para restablecer la contraseña (válido por 24 horas)

### CA-004: Permisos de Admin

- **Dado** que tengo rol Admin
- **Cuando** accedo al sistema
- **Entonces** puedo: gestionar usuarios, configurar sistema, acceder a todos los datos y funciones

### CA-005: Permisos de Usuario

- **Dado** que tengo rol Usuario
- **Cuando** accedo al sistema
- **Entonces** puedo: gestionar datos maestros, registrar transacciones, ver dashboard, planificar. NO puedo gestionar usuarios ni configuración avanzada

### CA-006: Permisos de Solo Lectura

- **Dado** que tengo rol Solo Lectura
- **Cuando** accedo al sistema
- **Entonces** puedo: ver dashboard, consultar datos, ver reportes. NO puedo crear, editar ni eliminar nada

### CA-007: Gestionar usuarios (Admin)

- **Dado** que soy Admin
- **Cuando** accedo a gestión de usuarios
- **Entonces** puedo: crear usuarios, asignar roles, desactivar usuarios, resetear contraseñas

### CA-008: Aislamiento de datos por tenant

- **Dado** que existen múltiples organizaciones usando GIIA
- **Cuando** accedo al sistema
- **Entonces** solo veo datos de MI organización, nunca de otras

---

## Escenarios Alternativos

### Escenario: Sesión expirada

- **Dado** que mi sesión lleva 30 minutos sin actividad
- **Cuando** intento realizar una acción
- **Entonces** el sistema me redirige a login pidiendo autenticarme nuevamente

### Escenario: Usuario desactivado

- **Dado** que mi cuenta ha sido desactivada por un Admin
- **Cuando** intento acceder
- **Entonces** el sistema indica "Usuario desactivado. Contacte al administrador"

---

## Notas y Aclaraciones

- Las contraseñas se almacenan hasheadas (nunca en texto plano)
- Toda la comunicación usa HTTPS
- Los intentos de login fallidos se registran para detectar posibles ataques
- El rol se asigna al crear el usuario y solo Admin puede modificarlo

---

## Checklist de Validación

- [x] La historia sigue el formato "Como... Quiero... Para..."
- [x] El valor/beneficio está claramente expresado
- [x] Hay al menos 1 criterio de aceptación
- [x] Los criterios siguen el formato Given/When/Then
- [x] Los RF relacionados están correctamente referenciados
- [x] La prioridad MoSCoW está asignada

---

## Señal de Completación

> Historia de usuario HU-019 completada.
