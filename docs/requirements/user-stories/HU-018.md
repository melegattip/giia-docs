# HU-018: Importar Datos Masivamente

---

## Metadata

| Campo | Valor |
|-------|-------|
| **ID** | HU-018 |
| **Prioridad** | Must |
| **RF Relacionados** | RF-090, RF-091, RF-092, RF-093, RF-094 |
| **Módulo/Componente** | Entrada de Datos - Importación CSV |
| **Estado** | Reviewed |

---

## Historia de Usuario

**Como** Administrador del sistema,  
**Quiero** importar datos masivamente desde archivos CSV,  
**Para** cargar catálogos completos e históricos de transacciones sin ingreso manual uno por uno.

---

## Criterios de Aceptación

### CA-001: Importar productos por CSV

- **Dado** que tengo un archivo CSV con 500 productos
- **Cuando** subo el archivo y mapeo las columnas
- **Entonces** el sistema crea los 500 productos en una sola operación mostrando el progreso de la importacion.

### CA-002: Mapeo de columnas

- **Dado** que mi archivo tiene columnas con nombres diferentes a los esperados
- **Cuando** llego a la pantalla de mapeo
- **Entonces** puedo indicar qué columna de mi archivo corresponde a cada campo del sistema

### CA-003: Importar transacciones históricas

- **Dado** que tengo un archivo CSV con histórico de ventas de 12 meses
- **Cuando** subo el archivo como "Histórico de ventas"
- **Entonces** el sistema registra las transacciones y las usa para calcular CPD

### CA-004: Validación pre-importación

- **Dado** que subo un archivo CSV
- **Cuando** el sistema lo procesa
- **Entonces** muestra preview con: registros válidos, registros con error, detalle de errores por línea

### CA-005: Confirmar o rechazar importación

- **Dado** que el preview muestra 480 válidos y 20 con error
- **Cuando** decido cómo proceder
- **Entonces** puedo: importar solo los válidos, corregir el archivo y reintentar, corregir los errores desde la interfaz o cancelar

### CA-006: Descargar templates

- **Dado** que necesito conocer el formato esperado
- **Cuando** accedo a la pantalla de importación
- **Entonces** puedo descargar templates CSV para: Productos, Proveedores, Histórico de ventas

### CA-007: Log de importaciones

- **Dado** que he realizado varias importaciones
- **Cuando** accedo al historial de importaciones
- **Entonces** veo: fecha, tipo, archivo, registros importados, errores, usuario que importó

---

## Escenarios Alternativos

### Escenario: Archivo con encoding incorrecto

- **Dado** que subo un CSV con encoding Latin-1 en lugar de UTF-8
- **Cuando** el sistema detecta caracteres extraños
- **Entonces** sugiere cambiar el encoding y permite seleccionar alternativas

### Escenario: Actualizar productos existentes

- **Dado** que importo un CSV con productos que ya existen (mismo SKU)
- **Cuando** proceso la importación
- **Entonces** el sistema pregunta si deseo actualizar los existentes o ignorarlos

---

## Notas y Aclaraciones

- La importación de productos permite carga inicial del catálogo completo
- La importación de histórico es fundamental para calcular CPD desde el día 1
- El límite de archivo es 5000 registros por importación (RNF-004)
- Los archivos muy grandes pueden procesarse en background con notificación al completar

---
